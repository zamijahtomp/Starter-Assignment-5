services:
  # 1. Django Web Service
  - type: web
    name: boggle-backend
    env: python
    
    # FIX 1: Run collectstatic during the build
    buildCommand: "pip install -r requirements.txt && python manage.py collectstatic --noinput"
    
    # FIX 2: Correctly reference your project's WSGI application
    startCommand: "gunicorn boggle_backend.wsgi" 
    
    healthCheckPath: "/admin/" # Or any simple endpoint
    envVars:
      - key: SECRET_KEY
        generateValue: true
      - key: WEB_CONCURRENCY
        value: 4
      - key: DEBUG
        value: "False"
      
      # Set up your Database URL
      - key: DATABASE_URL
        fromDatabase:
          # Match the DB name below
          name: boggle-db
          property: connectionString
    
    # FIX 3: REMOVE the staticFiles block completely
    # Do not include staticFiles: here if using WhiteNoise.

  # 2. PostgreSQL Database Service
  - type: pserv
    # FIX 4: Use a project-specific name
    name: boggle-db
    plan: starter # Choose your plan